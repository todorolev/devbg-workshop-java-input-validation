## Тодор Олев
## https://www.linkedin.com/in/todor-olev-81519825/
## todor.olev@gmail.com
<br/>
<br/>

# Валидация на аргументите при създаване на обекти в Java

## От къде идват данните?
Нека си представим, че имаме приложение, което е достъпно в Интернет и което получава данни по някакъв комуникационен канал (напр. HTTP, WebSocket, messaging service). Трудно можем да определим от къде точно идват данните - кой ги е създал и как са били променяни преди да достигнат до нашето приложение. Ако аз изпратя някакви данни към приложението, по някой от неговите комуникационни канали, то аз мога да се постарая да изпратя точно такива данни, с които приложението ще работи добре и както се очаква, няма да се "чупи" и няма да изпадне в неочаквано състояние. Нека си представим, че не аз, а Страхил ще определя какви данни ще се изпращат към приложението. Страхил може да не знае как да подготви данните и да изпрати нещо, което приложението не може да "разбере". Или Страхил може да иска нарочно да доведе приложението до неочаквано или нестабилно състояние. След като е наблюдавал поведението на приложението Страхил смята, че е разбрал как да подготви данните така, че да навреди на рботата на приложението или на данните, с които то работи. 

Кой е Страхил? 

Страхил е източник на данни, които достигат до нашето приложение - може да е човек или софтуер. Не е разумно просто да приемем, че той се съобразява с начините на работа в приложението или че има добри намерения. Много по-разумно би било да защитим приложението си, както и данните, с които то работи.

От гледна точка на използваемостта и на софтуерната сигурност един от защитните механизми, които можем да приложим, е валидация на входните данни.[^1]

## Валидация на входните данни
Валидацията на входните данни представлява проверка, че данните пристигат в състояние, което е очаквано и отговаря на определени изисквания. Данни, които не са в очаквано състояние или не отговарят на изискванията, биват "отхвърлени" и не достигат до "вътрешността" на софтуера.

### Къде е "вътрешността" на софуера?
По друг начин този въпрос може да звучи като *"Кога можем да вземем решение да отхвърлим данните?"*. Трудно е да се определи еднозначно къде е "пределната линия" до която ще допускаме невалидирани данни. Ако софтуерът ни използва база от данни, то обикновено важи правилото, че невалидирани данни не би трябвало да достигат до базата. Много често обаче това не е достатъчна защита. 

(Нека да се върнем към примера с нашето приложение, с което се е заел Страхил. Не се притесняваме за данните, които влизат в базата от данни, защото сме изградили непробиваема защита пред нея, чрез която всички данните се валидират прецизно. )

ДБ Защита

Ако данните достигнат нашето приложение и след това "пътуват" между различни компоненти, класове и методи, преди да достигнат базата от данни, то те отново биха могли да навредят. От гледна точка на използваемостта на приложението може да наблюдаваме неочаквано поведение - например грешки, "замърсяване" на лог-съобщенията, показване на неподходящо съдържание или дори отказ или значително забавяне. От гледна точка на софтуерната сигурност също има редица потенциални проблеми, например XSS, directory traversal, проблеми при ъплоуд на файлове, отново показване на неподходящо съдържание и други.
 
## Създаване на обекти от входни данни. Десериализация.
## Имплементиране на „вградена“ валидация.

[^1]:често валидацията на входните данни се споменава заедно със санитизацията на изходните данни. Санитизацията е превръщането на данните в подходящ формат за контекста, за който са предназначени. Например, ако поставяме текст в HTML (контекстът е HTML уеб страница), то трябва да се погрижим текстът да не съдържа специалните символи от HTML (<>, /, ", ', &), за да предотвратим редица проблеми, например: текстът да не изглежда добре, да "счупим" DOM дървото, да допуснем злонамерено добавяне на javascript. Санитизацията на данни е механизъм за подобряване на използваемостта и на софтуерната сигурност, но сега ще обърнем по-специално внимание на валидацията на входните данни.